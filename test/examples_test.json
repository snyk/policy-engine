{
    "format": "results",
    "format_version": "1.2.0",
    "rule_bundles": [
      {
        "rule_bundle": {
          "name": "../pkg/bundle/v1/test_inputs/complete",
          "source": "bundle_directory"
        }
      },
      {
        "rule_bundle": {
          "name": "../pkg/bundle/v1/test_inputs/minimal",
          "source": "bundle_directory"
        }
      },
      {
        "rule_bundle": {
          "source": "data"
        },
        "errors": [
          "Failed to compile rules: 2 errors occurred:\n../examples/02-simple-attributes.rego:23: rego_unsafe_var_error: var bucket is unsafe\n../examples/02-simple-attributes.rego:28: rego_unsafe_var_error: var bucket is unsafe"
        ]
      }
    ],
    "results": [
      {
        "input": {
          "format": "",
          "format_version": "",
          "input_type": "tf_hcl",
          "environment_provider": "iac",
          "meta": {
            "filepath": "../examples/main.tf"
          },
          "resources": {
            "aws_cloudtrail": {
              "aws_cloudtrail.cloudtrail1": {
                "id": "aws_cloudtrail.cloudtrail1",
                "resource_type": "aws_cloudtrail",
                "namespace": "../examples/main.tf",
                "meta": {
                  "location": [
                    {
                      "filepath": "../examples/main.tf",
                      "line": 55,
                      "column": 1
                    }
                  ],
                  "region": "us-east-1",
                  "terraform": {
                    "provider_config": {
                      "region": "us-east-1"
                    }
                  }
                },
                "attributes": {
                  "include_global_service_events": true,
                  "name": "cloudtrail1",
                  "s3_bucket_name": "aws_s3_bucket.bucket1",
                  "s3_key_prefix": "prefix"
                }
              }
            },
            "aws_kms_key": {
              "aws_kms_key.key": {
                "id": "aws_kms_key.key",
                "resource_type": "aws_kms_key",
                "namespace": "../examples/main.tf",
                "meta": {
                  "location": [
                    {
                      "filepath": "../examples/main.tf",
                      "line": 24,
                      "column": 1
                    }
                  ],
                  "region": "us-east-1",
                  "terraform": {
                    "provider_config": {
                      "region": "us-east-1"
                    }
                  }
                },
                "attributes": {
                  "deletion_window_in_days": 10,
                  "description": "This key is used to encrypt bucket objects"
                }
              }
            },
            "aws_s3_bucket": {
              "aws_s3_bucket.aes_bucket": {
                "id": "aws_s3_bucket.aes_bucket",
                "resource_type": "aws_s3_bucket",
                "namespace": "../examples/main.tf",
                "meta": {
                  "location": [
                    {
                      "filepath": "../examples/main.tf",
                      "line": 41,
                      "column": 1
                    }
                  ],
                  "region": "us-east-1",
                  "terraform": {
                    "provider_config": {
                      "region": "us-east-1"
                    }
                  }
                },
                "attributes": {
                  "bucket": "i-use-aes-encryption"
                }
              },
              "aws_s3_bucket.bucket1": {
                "id": "aws_s3_bucket.bucket1",
                "resource_type": "aws_s3_bucket",
                "namespace": "../examples/main.tf",
                "meta": {
                  "location": [
                    {
                      "filepath": "../examples/main.tf",
                      "line": 5,
                      "column": 1
                    }
                  ],
                  "region": "us-east-1",
                  "terraform": {
                    "provider_config": {
                      "region": "us-east-1"
                    }
                  }
                },
                "attributes": {
                  "bucket": "dumb-bucket"
                }
              },
              "aws_s3_bucket.bucket2": {
                "id": "aws_s3_bucket.bucket2",
                "resource_type": "aws_s3_bucket",
                "namespace": "../examples/main.tf",
                "meta": {
                  "location": [
                    {
                      "filepath": "../examples/main.tf",
                      "line": 9,
                      "column": 1
                    }
                  ],
                  "region": "us-east-1",
                  "terraform": {
                    "provider_config": {
                      "region": "us-east-1"
                    }
                  }
                },
                "attributes": {
                  "bucket": "dumb"
                }
              },
              "aws_s3_bucket.bucket3": {
                "id": "aws_s3_bucket.bucket3",
                "resource_type": "aws_s3_bucket",
                "namespace": "../examples/main.tf",
                "meta": {
                  "location": [
                    {
                      "filepath": "../examples/main.tf",
                      "line": 29,
                      "column": 1
                    }
                  ],
                  "region": "us-east-1",
                  "terraform": {
                    "provider_config": {
                      "region": "us-east-1"
                    }
                  }
                },
                "attributes": {
                  "bucket": "bucket3",
                  "server_side_encryption_configuration": [
                    {
                      "rule": [
                        {
                          "apply_server_side_encryption_by_default": [
                            {
                              "kms_master_key_id": "aws_kms_key.key",
                              "sse_algorithm": "aws:kms"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              }
            },
            "aws_s3_bucket_server_side_encryption_configuration": {
              "aws_s3_bucket_server_side_encryption_configuration.aes_bucket": {
                "id": "aws_s3_bucket_server_side_encryption_configuration.aes_bucket",
                "resource_type": "aws_s3_bucket_server_side_encryption_configuration",
                "namespace": "../examples/main.tf",
                "meta": {
                  "location": [
                    {
                      "filepath": "../examples/main.tf",
                      "line": 45,
                      "column": 1
                    }
                  ],
                  "region": "us-east-1",
                  "terraform": {
                    "provider_config": {
                      "region": "us-east-1"
                    }
                  }
                },
                "attributes": {
                  "bucket": "i-use-aes-encryption",
                  "rule": [
                    {
                      "apply_server_side_encryption_by_default": [
                        {
                          "sse_algorithm": "AES256"
                        }
                      ]
                    }
                  ]
                }
              },
              "aws_s3_bucket_server_side_encryption_configuration.bucket2": {
                "id": "aws_s3_bucket_server_side_encryption_configuration.bucket2",
                "resource_type": "aws_s3_bucket_server_side_encryption_configuration",
                "namespace": "../examples/main.tf",
                "meta": {
                  "location": [
                    {
                      "filepath": "../examples/main.tf",
                      "line": 13,
                      "column": 1
                    }
                  ],
                  "region": "us-east-1",
                  "terraform": {
                    "provider_config": {
                      "region": "us-east-1"
                    }
                  }
                },
                "attributes": {
                  "bucket": "dumb",
                  "rule": [
                    {
                      "apply_server_side_encryption_by_default": [
                        {
                          "kms_master_key_id": "aws_kms_key.key",
                          "sse_algorithm": "aws:kms"
                        }
                      ]
                    }
                  ]
                }
              }
            },
            "kubernetes_pod": {
              "kubernetes_pod.multiple_containers": {
                "id": "kubernetes_pod.multiple_containers",
                "resource_type": "kubernetes_pod",
                "namespace": "../examples/main.tf",
                "meta": {
                  "location": [
                    {
                      "filepath": "../examples/main.tf",
                      "line": 62,
                      "column": 1
                    }
                  ]
                },
                "attributes": {
                  "metadata": [
                    {
                      "name": "multiple-containers"
                    }
                  ],
                  "spec": [
                    {
                      "container": [
                        {
                          "env": [
                            {
                              "name": "environment",
                              "value": "test"
                            }
                          ],
                          "image": "nginx:1.7.9",
                          "name": "example-allowed"
                        },
                        {
                          "env": [
                            {
                              "name": "environment",
                              "value": "test"
                            }
                          ],
                          "image": "nginx:1.7.9",
                          "name": "example-denied",
                          "security_context": [
                            {
                              "privileged": true
                            }
                          ]
                        },
                        {
                          "env": [
                            {
                              "name": "environment",
                              "value": "test"
                            }
                          ],
                          "image": "nginx:1.7.9",
                          "name": "example-denied-2",
                          "security_context": [
                            {
                              "privileged": true
                            }
                          ]
                        }
                      ],
                      "init_container": [
                        {
                          "args": [
                            "-c",
                            "exit",
                            "0"
                          ],
                          "command": [
                            "/bin/sh"
                          ],
                          "env": [
                            {
                              "name": "environment",
                              "value": "test"
                            }
                          ],
                          "image": "nginx:1.7.9",
                          "name": "example-denied-init",
                          "security_context": [
                            {
                              "privileged": true
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              }
            }
          },
          "scope": {
            "filepath": "../examples/main.tf"
          }
        },
        "rule_results": [
          {
            "id": "EXAMPLE_01",
            "rule_bundle": {
              "name": "../pkg/bundle/v1/test_inputs/complete",
              "source": "bundle_directory"
            },
            "title": "Bucket name contains the word 'bucket'",
            "resource_types": [
              "aws_s3_bucket"
            ],
            "results": [
              {
                "passed": true,
                "ignored": false,
                "resource_id": "aws_s3_bucket.aes_bucket",
                "resource_namespace": "../examples/main.tf",
                "resource_type": "aws_s3_bucket",
                "resources": [
                  {
                    "id": "aws_s3_bucket.aes_bucket",
                    "type": "aws_s3_bucket",
                    "namespace": "../examples/main.tf",
                    "location": [
                      {
                        "filepath": "../examples/main.tf",
                        "line": 41,
                        "column": 1
                      }
                    ],
                    "attributes": [
                      {
                        "path": [
                          "bucket"
                        ],
                        "location": {
                          "filepath": "../examples/main.tf",
                          "line": 42,
                          "column": 3
                        }
                      },
                      {
                        "path": [
                          "bucket_prefix"
                        ],
                        "location": {
                          "filepath": "../examples/main.tf",
                          "line": 41,
                          "column": 1
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "passed": false,
                "ignored": false,
                "resource_id": "aws_s3_bucket.bucket1",
                "resource_namespace": "../examples/main.tf",
                "resource_type": "aws_s3_bucket",
                "resources": [
                  {
                    "id": "aws_s3_bucket.bucket1",
                    "type": "aws_s3_bucket",
                    "namespace": "../examples/main.tf",
                    "location": [
                      {
                        "filepath": "../examples/main.tf",
                        "line": 5,
                        "column": 1
                      }
                    ],
                    "attributes": [
                      {
                        "path": [
                          "bucket"
                        ],
                        "location": {
                          "filepath": "../examples/main.tf",
                          "line": 6,
                          "column": 3
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "passed": true,
                "ignored": false,
                "resource_id": "aws_s3_bucket.bucket2",
                "resource_namespace": "../examples/main.tf",
                "resource_type": "aws_s3_bucket",
                "resources": [
                  {
                    "id": "aws_s3_bucket.bucket2",
                    "type": "aws_s3_bucket",
                    "namespace": "../examples/main.tf",
                    "location": [
                      {
                        "filepath": "../examples/main.tf",
                        "line": 9,
                        "column": 1
                      }
                    ],
                    "attributes": [
                      {
                        "path": [
                          "bucket"
                        ],
                        "location": {
                          "filepath": "../examples/main.tf",
                          "line": 10,
                          "column": 3
                        }
                      },
                      {
                        "path": [
                          "bucket_prefix"
                        ],
                        "location": {
                          "filepath": "../examples/main.tf",
                          "line": 9,
                          "column": 1
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "passed": false,
                "ignored": false,
                "resource_id": "aws_s3_bucket.bucket3",
                "resource_namespace": "../examples/main.tf",
                "resource_type": "aws_s3_bucket",
                "resources": [
                  {
                    "id": "aws_s3_bucket.bucket3",
                    "type": "aws_s3_bucket",
                    "namespace": "../examples/main.tf",
                    "location": [
                      {
                        "filepath": "../examples/main.tf",
                        "line": 29,
                        "column": 1
                      }
                    ],
                    "attributes": [
                      {
                        "path": [
                          "bucket"
                        ],
                        "location": {
                          "filepath": "../examples/main.tf",
                          "line": 30,
                          "column": 3
                        }
                      }
                    ]
                  }
                ]
              }
            ],
            "package": "data.rules.EXAMPLE_01.terraform"
          },
          {
            "id": "EXAMPLE_02",
            "rule_bundle": {
              "name": "../pkg/bundle/v1/test_inputs/complete",
              "source": "bundle_directory"
            },
            "title": "Order includes cheeseburger pizza",
            "resource_types": [
              "data.dominos_menu_item"
            ],
            "results": [],
            "package": "data.rules.EXAMPLE_02.terraform"
          },
          {
            "rule_bundle": {
              "name": "../pkg/bundle/v1/test_inputs/minimal",
              "source": "bundle_directory"
            },
            "title": "Playlist lacks cowbell",
            "resource_types": [
              "spotify_playlist"
            ],
            "results": [],
            "package": "data.rules.playlist_guardrails"
          }
        ]
      }
    ]
  }